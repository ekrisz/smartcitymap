extends ../menu 
block content 
    div(class="container", id="admin")
        h1 Admin page
        p Be careful, this is the admin page
        div(class="card")
            div(class="card-body")
                if step === 0
                    h4(class="card-title") Map settings (step 1 of 2) 
                    div(class="card-text")
                        form(action="admin/save", method="post")
                            div(class="mb-3 mt-3")
                                label(for="url", class="form-label") API URL:
                                input(type="url", class="form-control", id="url", name="url", placeholder="e.g. https://example.com/api/v1/get", required, pattern="(http|https):\/\/.*", value=`${mapSettings.url}`)
                            div(class="mb-3 mt-3")
                                label(for="resourceID", class="form-label") Resource ID: 
                                input(type="text", class="form-control", name="resourceID", id="resourceID", placeholder="e.g. 564f9486-26b1-4e54-8328-bb1113566c86", value=`${mapSettings.resourceID}`, required)
                            input(type="hidden", name="step", value=0)
                            button(type="submit", class="btn btn-primary") Next
                if step === 1
                    h4(class="card-title") Map settings (step 2 of 2)
                    a(href="/admin?config=url", class="btn btn-sm btn-warning") Config the API URL 
                    a(href="/admin?config=query", class="btn btn-sm btn-warning") Config the query 
                    div(class="card-text")
                        form(action="admin/save", method="post")
                            - for(const field of fields) {
                                div(class="mb-3 mt-3")
                                    div(class="form-check")
                                    script.
                                        if(selectedFields.includes(field))   
                                            input(class="form-check-input", type="checkbox", name="fields", value=`${field.id}`, checked))
                                        else 
                                    input(class="form-check-input", type="checkbox", name="fields", value=`${field.id}`)
                                    label(class="form-check-label", for=`${field.id}`) #{field.id} (#{field.type})
                            - }
                            input(type="hidden", name="step", value=1)
                            button(type="submit", class="btn btn-primary") Save
                if step === 2
                    h4(class="card-title") Query settings
                    div(class="card-text")
                        form(action="admin/save", method="post")
                            div(class="mb-3 mt-3")
                                label(for="query", class="form-label") Text contained:
                                input(type="text", class="form-control", id="query", name="query", placeholder="e.g. John Doe", value=`${mapSettings.query}`)
                            div(class="mb-3 mt-3")
                                label(for="limit", class="form-label") Query limit (not limited if 0): <b>[May less points will appear on the map because points with null longitudes and latitudes are not displayed]</b>
                                input(type="number", class="form-control", name="limit", id="limit", value=`${mapSettings.limit}`, placeholder="e.g. 50")
                            input(type="hidden", name="step", value=2)
                            button(type="submit", class="btn btn-primary") Save
    
        